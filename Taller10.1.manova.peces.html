<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES" xml:lang="es-ES"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez Barrios">
<meta name="dcterms.date" content="2023-03-21">

<title>Taller 10.1 Análisis de Varianza Multivariado - MANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Taller10.1.manova.peces_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller10.1.manova.peces_files/libs/quarto-html/quarto.js"></script>
<script src="Taller10.1.manova.peces_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller10.1.manova.peces_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller10.1.manova.peces_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller10.1.manova.peces_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller10.1.manova.peces_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller10.1.manova.peces_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller10.1.manova.peces_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller10.1.manova.peces_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#análisis-de-varianza-multivariado---manova---base-peces" id="toc-análisis-de-varianza-multivariado---manova---base-peces" class="nav-link active" data-scroll-target="#análisis-de-varianza-multivariado---manova---base-peces">Análisis de Varianza Multivariado - MANOVA - base <em>peces</em></a>
  <ul>
  <li><a href="#referencias-bibliográficas-de-apoyo." id="toc-referencias-bibliográficas-de-apoyo." class="nav-link" data-scroll-target="#referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</a>
  <ul class="collapse">
  <li><a href="#cargar-las-librerías-requeridas" id="toc-cargar-las-librerías-requeridas" class="nav-link" data-scroll-target="#cargar-las-librerías-requeridas">Cargar las librerías requeridas</a></li>
  <li><a href="#cargar-o-importar-la-base-de-datos" id="toc-cargar-o-importar-la-base-de-datos" class="nav-link" data-scroll-target="#cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</a></li>
  <li><a href="#exploración-de-los-datos" id="toc-exploración-de-los-datos" class="nav-link" data-scroll-target="#exploración-de-los-datos">Exploración de los datos</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cuatro-pasos-para-la-realización-del-manova" id="toc-cuatro-pasos-para-la-realización-del-manova" class="nav-link" data-scroll-target="#cuatro-pasos-para-la-realización-del-manova">Cuatro pasos para la realización del MANOVA</a>
  <ul>
  <li><a href="#paso-1.-pruebas-de-supuestos" id="toc-paso-1.-pruebas-de-supuestos" class="nav-link" data-scroll-target="#paso-1.-pruebas-de-supuestos">Paso 1. Pruebas de supuestos</a>
  <ul class="collapse">
  <li><a href="#supuesto-de-normalidad" id="toc-supuesto-de-normalidad" class="nav-link" data-scroll-target="#supuesto-de-normalidad">1.1 Supuesto de normalidad</a></li>
  <li><a href="#supuesto-de-homogeneidad-de-covarianzas" id="toc-supuesto-de-homogeneidad-de-covarianzas" class="nav-link" data-scroll-target="#supuesto-de-homogeneidad-de-covarianzas">1.2 Supuesto de homogeneidad de covarianzas</a></li>
  </ul></li>
  <li><a href="#paso-2.-análisis-de-varinaza-multivariado---manova" id="toc-paso-2.-análisis-de-varinaza-multivariado---manova" class="nav-link" data-scroll-target="#paso-2.-análisis-de-varinaza-multivariado---manova">Paso 2. Análisis de Varinaza Multivariado - MANOVA</a></li>
  <li><a href="#paso-3.-supuestos-del-manova" id="toc-paso-3.-supuestos-del-manova" class="nav-link" data-scroll-target="#paso-3.-supuestos-del-manova">Paso 3. Supuestos del MANOVA</a></li>
  <li><a href="#supuesto-de-normalidad-de-los-residuales-del-manova" id="toc-supuesto-de-normalidad-de-los-residuales-del-manova" class="nav-link" data-scroll-target="#supuesto-de-normalidad-de-los-residuales-del-manova">3.1. Supuesto de normalidad de los residuales del MANOVA</a></li>
  <li><a href="#supuesto-de-independencia" id="toc-supuesto-de-independencia" class="nav-link" data-scroll-target="#supuesto-de-independencia">3.2. Supuesto de independencia</a></li>
  <li><a href="#paso-4.-prueba-a-postriori-del-manova" id="toc-paso-4.-prueba-a-postriori-del-manova" class="nav-link" data-scroll-target="#paso-4.-prueba-a-postriori-del-manova">Paso 4. Prueba a postriori del MANOVA</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller 10.1 Análisis de Varianza Multivariado - MANOVA</h1>
<p class="subtitle lead">Datos de morfométricos de peces de ríos de la India</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Javier Rodríguez Barrios </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 21, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="análisis-de-varianza-multivariado---manova---base-peces" class="level1"><b style="color:#1f78b4;">
<h1>Análisis de Varianza Multivariado - MANOVA - base <em>peces</em></h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<p><strong>Objetivo de la actividad:</strong></p>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La base de datos que se utilizará es la de medidas morfométricas de peces de un estudio realizado con peces de la india por <strong>Gupta et al.&nbsp;(2018)</strong> <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6203374/">Articulo fuente</a> en los que se validó la taxonomía de peces de la subfamilia Barbinae, utilizando 19 variables morfométricas y 19 variables meristicas, correspondientes a 5 Especie de la familia en mención.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Imagenes/peces.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption"><n style="color:#1f78b4;"> Imágen tomada de <em>Gupta et al.&nbsp;(2018)</em> (a) <em>S . Sarana</em> (b) <em>P . ticto</em> (c) <em>P . sóforo</em> , (d) <em>P . conconio</em> y (e) <em>P . chola</em> </n></figcaption><p></p>
</figure>
</div>
<p>El <strong>objetivo</strong> de este ejercicio consiste en comparar los promedios multivariados de las variables morfométricas que caracterizan a los peces de cada especie (grupos en comparación), para conocer si los atributos morfométricos generan diferencias en cada grupo evaluado. La base de datos que se utilizará es <strong>peces.csv</strong>.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="referencias-bibliográficas-de-apoyo." class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p><a href="https://www.editdiazdesantos.com/libros/9788490524817/Rodr%C3%ADguez-Barrios-An%C3%A1lisis-de-datos-ecol%C3%B3gicos-y-ambientales-aplicaciones-con-el-programa-R.html?isbn=978849052481">Libro: Análisis de datos ecológicos y ambientales - Rodríguez-Barrios Javier 2023</a> Ver el capítulo de MANOVA, en donde se detallan los procedimientos descritos en el presente ejercicio.</p>
<p><a href="https://www.r-bloggers.com/2021/11/manovamultivariate-analysis-of-variance-using-r/">MANOVA(Multivariate Analysis of Variance)</a> Este documento presenta información relevante sobre la fundamentación de los MANOVAs y su análisis en R</p>
<p><a href="https://www.r-bloggers.com/2022/05/how-to-perform-the-manova-test-in-r/?utm_source=phpList&amp;utm_medium=email&amp;utm_campaign=R-bloggers-daily&amp;utm_content=HTML">How to perform the MANOVA test in R</a> Este documento brinda información sobre los supuestos del MANOVA y la forma de realizar esta prueba multivariada en R.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="cargar-las-librerías-requeridas" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="cargar-las-librerías-requeridas">Cargar las librerías requeridas</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías requeridas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)          <span class="co"># Para el permutes en homogeneidad de covarianzas</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)     <span class="co"># Prueba de normalidad "mshapiro.test"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"funciones.r"</span>)   <span class="co"># Figuras de normalidad multivariada</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)              <span class="co"># Para ejecutar el diagnóstico de independencia</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cargar-o-importar-la-base-de-datos" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La presente base de datos se encuentra en formato plano de <code>csv</code>, presenta una columna <code>Especie</code> que agrupa a las 5 Especie de peces, otra columna <code>Grupo</code>, que asigna un número a cada especie y posteriormente a las 19 variables morfométricas y 10 variables meristicas, de las cuales se selecionarán las 19 morfométricas para este ejercicio <code>M.1</code> a <code>M.19</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>peces<span class="ot">&lt;-</span><span class="fu">read.csv2</span>(<span class="st">"peces.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Especie" "Grupo"   "M.1"     "M.2"     "M.3"     "M.4"     "M.5"    
 [8] "M.6"     "M.7"     "M.8"     "M.9"     "M.10"    "M.11"    "M.12"   
[15] "M.13"    "M.14"    "M.15"    "M.16"    "M.17"    "M.18"    "M.19"   
[22] "M.20"    "M.21"    "M.22"    "M.23"    "M.24"    "M.25"    "M.26"   
[29] "M.27"    "M.28"    "M.29"   </code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="exploración-de-los-datos" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="exploración-de-los-datos">Exploración de los datos</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Para este ejemplo se urtilizarán figuras que relacionan parejas de variables y figuras de cajas que permitan visualizar diferencias entre las Especie de peces de acuerdo a su morfometría. *Para facilidad del ejercicio se seleccionarán algunas variables morfométricas - <code>peces1</code>, debido a que son las que presentan mejores patrones lineales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores con variables morfométricas</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>peces1 <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cor</span>(peces1)            <span class="co"># Matriz de Correlación (M)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura1">Figura&nbsp;1</a> permite visualizar la resolución de cada variable para diferenciar o discriminar a las diferentes especies de peces. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminación de las especies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras multivariadas de Cajas y bigotes</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(peces[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]), <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Especie)) <span class="sc">+</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>)) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"Morfometría"</span>) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,<span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.manova.peces_files/figure-html/fig-figura1-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;1: Variación en la morfometría de los peces, de acuerdo a cada una de las variables seleccionadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cuatro-pasos-para-la-realización-del-manova" class="level1"><b style="color:#1f78b4;">
<h1>Cuatro pasos para la realización del MANOVA</h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="paso-1.-pruebas-de-supuestos" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-1.-pruebas-de-supuestos">Paso 1. Pruebas de supuestos</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Para que el análisis de varianza multivariado - manova sea considerado como un modelo lineal, debe cumplir con los supuestos de normalidad multivariada, de homogeneidad de covarianzas y de independencia. Para el caso del presente ejercicio, los dos primeros supuestos no alcanzan a cumplirse con los diagnosticos utilizados (valor p &lt; 0.05), motivo por el cual, el <code>manova</code> de este ejercicio será tomado como una técnica de exploración multivariada para evaluar las diferencias en las 5 especies, basado en las 10 variables morfomètricas seleccionadas.En el siguiente ejercicio se realizarán análisis de varianza no paramétricos <code>pemanovas</code>, que permiten probar hipótesis sin el cumplimiento de ls dos primeros supuestos, por lo cual serán los diseños multivariados más apropiados para esta base de datos.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="supuesto-de-normalidad" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="supuesto-de-normalidad">1.1 Supuesto de normalidad</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El supuesto de normalidad multivariada será evaluado con el paquete <code>mvnormtest</code>, el cual utiliza el estadìstico de <code>Shapiro Wilks Multivariado</code>. Para ello se realizarà esta prueba en cada uno de los grupos o especies en comparación. <strong>NOTA</strong>: Este supuesto también será evaluado con los <code>residuales del manova</code>, posterior a su ejecución.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnóstico de normalidad por cada tipo de Especie</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Los siguientes generan los dataframes de cada especie con las 10 variables seleccionadas, convirtiendola ademàs en formato matricial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe por cada especie</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. chola.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>P.chola   <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. chola"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. conchonious.</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>P.concho  <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. conchonious"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>() </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. sophore.</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>P.sophore <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. sophore"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()     </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. ticto.</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>P.ticto   <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. ticto"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()       </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. ticto.</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>S.sarana  <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"S. sarana"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vale la pena resaltar que los datos de las especies P. chola y P. sophore, son singulares, por lo cual no puede calcularse su supuesto de normalidad multivariada. Con el objeto de continuar en el ejercicio, las matrices que representan a las especies en menciòn, seràn desactivadas con <code>#</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de normalidad para cada especie</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># norm1 &lt;- mshapiro.test(t(P.chola))   # Matriz singular</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>norm2   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(P.concho))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># norm3 &lt;- mshapiro.test(t(P.sophore)) # Matriz singular</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>norm4   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(P.ticto))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>norm5   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(S.sarana))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se resume el resultado de los tres diagnósticos de normalidad multivariada realizados. Vale la pena mencionar que ninguna especie cumple con dicho supuesto estadóstico (valores p &lt; 0.05), aunque existe la posibilidad de probar con alguna transformación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de el diagnóstico de normalidad</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">normalidad =</span> <span class="fu">data.frame</span>(<span class="at">Norm.P.concho =</span> norm2<span class="sc">$</span>p.value,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.ticto    =</span> norm4<span class="sc">$</span>p.value,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.sarana   =</span> norm5<span class="sc">$</span>p.value))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Norm.P.concho   Norm.ticto  Norm.sarana
1   0.001050723 2.629679e-08 5.169222e-07</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="supuesto-de-homogeneidad-de-covarianzas" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="supuesto-de-homogeneidad-de-covarianzas">1.2 Supuesto de homogeneidad de covarianzas</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La prueba de homogeneidad de covarianza o <strong>esfericidad</strong>, corresponde al segundo supuesto del análisis discriminante lineal, se utilizará la función <code>betadisper</code>, la cual es complementada por dos análisis de varianza, los cuales definirán si el supuesto logra ser cumplido.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas de Homogeneidad de covarianzas paquete "vegan"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>peces.d <span class="ot">&lt;-</span> <span class="fu">dist</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)])                <span class="co"># Matriz de distancias</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>peces.homoge <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(peces.d, peces<span class="sc">$</span>Especie)      <span class="co"># Permutest</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con la siguiente <code>anova</code> se obtiene un valor p de 0.016*, lo cual indica que no se cumple el supuesto de homogeneidad de covarianzas (valor p &lt; 0.05).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Prueba con anova permutacional</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(peces.homoge)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df   Sum Sq   Mean Sq F value  Pr(&gt;F)  
Groups     4 0.019804 0.0049509   3.281 0.01638 *
Residuals 65 0.098082 0.0015090                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Con el <code>permutest</code> se obtiene un valor p de 0.015*, lo cual indica que tampoco se cumple el supuesto de homogeneidad de covarianzas (valor p &lt; 0.05).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Prueba permutacional</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(peces.homoge)   <span class="co"># Se cumple el supuesto de homogeneidad </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df   Sum Sq   Mean Sq     F N.Perm Pr(&gt;F)  
Groups     4 0.019804 0.0049509 3.281    999  0.015 *
Residuals 65 0.098082 0.0015090                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-2.-análisis-de-varinaza-multivariado---manova" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-2.-análisis-de-varinaza-multivariado---manova">Paso 2. Análisis de Varinaza Multivariado - MANOVA</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El manova, por ser un modelo lineal especial, requiere que se indiquen las variables continuas (variables Xi) y la variable cualitativa o categórica (variable Yi), que para este caso es la Especie.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manova (variables efecto: 10 morfológicas y la respuesta: Especie)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>peces.manova<span class="ot">&lt;-</span><span class="fu">manova</span>(<span class="fu">cbind</span>(M<span class="fl">.1</span>,M<span class="fl">.2</span>,M<span class="fl">.3</span>,M<span class="fl">.4</span>,M<span class="fl">.5</span>,M<span class="fl">.6</span>,M<span class="fl">.7</span>,M<span class="fl">.13</span>,M<span class="fl">.15</span>,M<span class="fl">.18</span>)<span class="sc">~</span>Especie)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se presentará la tabla del manova para las tres primeras variables morfométricas. Para visualizar todos los resultados de este insumo, es necesario colocar solo: <code>summary.aov(peces.manova)</code>. Para este caso se observa que todas las variables efecto o morfológicas, tienen un efecto muy significativo (valor p &lt;&lt;0.01) en la diferenciaciación de los 5 grupos o especies de peces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># respuesta de la variable M.1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(peces.manova)<span class="sc">$</span><span class="st">" Response M.1"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    
Especie      4 0.221052 0.055263  127.36 &lt; 2.2e-16 ***
Residuals   65 0.028205 0.000434                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># respuesta de la variable M.2</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(peces.manova)<span class="sc">$</span><span class="st">" Response M.2"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
Especie      4 0.28343 0.070857   34.76 1.654e-15 ***
Residuals   65 0.13250 0.002038                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># respuesta de la variable M.3</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(peces.manova)<span class="sc">$</span><span class="st">" Response M.3"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df   Sum Sq    Mean Sq F value   Pr(&gt;F)    
Especie      4 0.010738 0.00268443  10.486 1.29e-06 ***
Residuals   65 0.016641 0.00025601                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>A continuación se presentan los cuatro tipos de MANOVAS, con la diferencia de que Hotelling puede utilizarse sin el cumplimiento del supuesto de normalidad multivariada (pero deben cumplirse los otros supuestos como el de la homogeneidad y el de la independencia). Para este caso los 4 estadísticos muestran altas diferencias entre algunos de los grupos representados por las cinco especies, posiblemente por el efecto de P. sarana, que al ser de un género diferente, presenta marcadas diferencias morfológicas (ver <a href="#fig-figura3">Figura&nbsp;3</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tipos de MANOVA para evaluar si hay diferencias en los promedios de cada Especie </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peces.manova,<span class="at">test=</span><span class="st">"Pillai"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Df Pillai approx F num Df den Df    Pr(&gt;F)    
Especie    4  2.513   9.9711     40    236 &lt; 2.2e-16 ***
Residuals 65                                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peces.manova,<span class="at">test=</span><span class="st">"Wilks"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Df     Wilks approx F num Df den Df    Pr(&gt;F)    
Especie    4 0.0028912   19.667     40  214.2 &lt; 2.2e-16 ***
Residuals 65                                               
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peces.manova,<span class="at">test=</span><span class="st">"Hotelling"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Df Hotelling-Lawley approx F num Df den Df    Pr(&gt;F)    
Especie    4           29.052   39.584     40    218 &lt; 2.2e-16 ***
Residuals 65                                                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peces.manova,<span class="at">test=</span><span class="st">"Roy"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Df    Roy approx F num Df den Df    Pr(&gt;F)    
Especie    4 23.757   140.17     10     59 &lt; 2.2e-16 ***
Residuals 65                                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-3.-supuestos-del-manova" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-3.-supuestos-del-manova">Paso 3. Supuestos del MANOVA</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>SOn tres los supuestos que a continuación se probarán: (1) Normalidad en los residuales, (2) homogeneidad de las covarianzas y (3) Independiencia en los datos. Vale la pena resaltar la importancia del cumplimiento de la independiencia, debido a que presenta un efecto sobre diseños que requieran ser aleatorios. La homogeneidad fue diagnosticada al inicio de este ejercicio no se cumple.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="supuesto-de-normalidad-de-los-residuales-del-manova" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="supuesto-de-normalidad-de-los-residuales-del-manova">3.1. Supuesto de normalidad de los residuales del MANOVA</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se probará el supuesto de (1) normalidad en los residuales del manova, de forma numérica y gráfica. El estadístico de Shapiro Wilks Multivariado es el que se utiliza, demostrando que los residuales están muy alejados del patrón normal (valor p &lt;&lt; 0.01 o p = 3.043e-07).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Prueba de multinormalidad de los residuales del manova (mshapiro.test)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">t</span>(<span class="fu">residuals</span>(peces.manova)))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mshapiro.test</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  Z
W = 0.83893, p-value = 3.043e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No se cumple este supuesto</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se hará uso del código fuente “<code>funciones.r</code>” el cual presenta los comandos requeridos para la figura que diagnostica la normalidad multivariada (<a href="#fig-figura2">Figura&nbsp;2</a> qqplot).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura de multinormalidad</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Funciones para la figura</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"funciones.r"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En la <a href="#fig-figura2">Figura&nbsp;2</a> se observa que algunos residuales (puntos circulares) se alejan considerablemente del patrón de normalidad, definido por la recta roja.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica QQ-PLot para visualizar la normalidad</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">residuals</span>(peces.manova)) </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># centroide</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x) </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x); p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x); cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(x); </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(x,center,cov) </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="fu">qchisq</span>(<span class="fu">ppoints</span>(n),<span class="at">df=</span>p),d,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="st">"Normalidad multivariada"</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">"Cuantil Chi-Cuadrado"</span>, <span class="at">xlab=</span> <span class="st">"Distancia Mahalanobish"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.manova.peces_files/figure-html/fig-figura2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;2: Figura qqplot entre los residuales observados (Distancia Mahalanobish) y los cuantiles chi cuadrado (estimados).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="supuesto-de-independencia" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="supuesto-de-independencia">3.2. Supuesto de independencia</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Se utilizará el estadístico Durbin Watson (DW) el cual demuestra que se cumple la independencia (valor p &gt; 0.05).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de Independencia - Estadistico Durbin Watson</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>modelo<span class="ot">&lt;-</span><span class="fu">lm</span>(M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span>M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span><span class="sc">~</span>Especie)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(modelo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1      0.08444408       1.80425    0.18
 Alternative hypothesis: rho != 0</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-4.-prueba-a-postriori-del-manova" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-4.-prueba-a-postriori-del-manova">Paso 4. Prueba a postriori del MANOVA</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación, se realizará una figura del análisis discriminante - <em>lda</em>, que permitirá generar definir al nivel de discriminación de cada grupo o especie de pez. Se presentan algunas opciones gráficas con el procedimiento general y con el análisis discriminate canónico (dca)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo del LDA</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Especie" "Grupo"   "M.1"     "M.2"     "M.3"     "M.4"     "M.5"    
 [8] "M.6"     "M.7"     "M.8"     "M.9"     "M.10"    "M.11"    "M.12"   
[15] "M.13"    "M.14"    "M.15"    "M.16"    "M.17"    "M.18"    "M.19"   
[22] "M.20"    "M.21"    "M.22"    "M.23"    "M.24"    "M.25"    "M.26"   
[29] "M.27"    "M.28"    "M.29"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dis<span class="ot">&lt;-</span><span class="fu">lda</span> (Especie <span class="sc">~</span> M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span>M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span>,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se realizará el componente grafico del lda, el cual inicia con una figura que definirá unas elipses, las cuales relacionan a los individuos de cada especie y cuyo solapamiento definirá el nivel de relación entre estas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores o coordenadas de las observaciones en cada eje can?nico</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos asignados por el AD</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas y grupos asignados</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>peces.coord<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Especie=</span>group,Fp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura3">Figura&nbsp;3</a> demuestra que si bien de presenta una buena discriminación de las especies de peces, 4 de las 5 evaluadas presentan cierta relación, definida por el solapamiento de sus elipses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del LDA</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot</span>(LD2<span class="sc">~</span>LD1 <span class="sc">|</span> Especie, <span class="at">data=</span>peces.coord,<span class="at">reg.line=</span><span class="cn">FALSE</span>, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">smooth=</span>F, <span class="at">spread=</span>F,<span class="at">span=</span> <span class="dv">1</span>,<span class="at">grid=</span>F,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend=</span><span class="fu">list</span>(<span class="at">coords=</span><span class="st">"bottom"</span>), </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ellipse=</span>T,<span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#e41a1c'</span>,<span class="st">'#984ea3'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main=</span><span class="st">"Análisis discriminante"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">font.main=</span><span class="dv">2</span>,<span class="at">cex.main=</span><span class="dv">2</span>,<span class="at">cex.lab=</span><span class="fl">1.5</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"Eje1"</span>, <span class="at">ylab=</span><span class="st">"Eje2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.manova.peces_files/figure-html/fig-figura3-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3: Mapa de calor que relaciona a las variables morfométricas y a las especies de peces.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>