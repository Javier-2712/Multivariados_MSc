<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES" xml:lang="es-ES"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez Barrios">
<meta name="dcterms.date" content="2023-03-18">

<title>Taller 5.1 Análisis de Escalamiento Multidimensional no Métrico - NMDS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Taller5.1.nmds.malezas_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller5.1.nmds.malezas_files/libs/quarto-html/quarto.js"></script>
<script src="Taller5.1.nmds.malezas_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller5.1.nmds.malezas_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller5.1.nmds.malezas_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller5.1.nmds.malezas_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller5.1.nmds.malezas_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller5.1.nmds.malezas_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller5.1.nmds.malezas_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller5.1.nmds.malezas_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#exploración-gráfica-multivariada---base-malezas" id="toc-exploración-gráfica-multivariada---base-malezas" class="nav-link active" data-scroll-target="#exploración-gráfica-multivariada---base-malezas">Exploración gráfica multivariada - base <em>malezas</em></a>
  <ul class="collapse">
  <li><a href="#procedimiento-de-la-exploración" id="toc-procedimiento-de-la-exploración" class="nav-link" data-scroll-target="#procedimiento-de-la-exploración">Procedimiento de la exploración</a>
  <ul class="collapse">
  <li><a href="#ordenación-de-las-localidades-y-las-especies-de-malezas." id="toc-ordenación-de-las-localidades-y-las-especies-de-malezas." class="nav-link" data-scroll-target="#ordenación-de-las-localidades-y-las-especies-de-malezas.">1) Ordenación de las localidades y las especies de malezas.</a></li>
  <li><a href="#figuras-del-nmds-con-el-paquete-vegan" id="toc-figuras-del-nmds-con-el-paquete-vegan" class="nav-link" data-scroll-target="#figuras-del-nmds-con-el-paquete-vegan">2) Figuras del nmds con el paquete “vegan”</a></li>
  <li><a href="#nmds-con-paquete-ggplot2" id="toc-nmds-con-paquete-ggplot2" class="nav-link" data-scroll-target="#nmds-con-paquete-ggplot2">3) NMDS con paquete ggplot2</a></li>
  </ul></li>
  <li><a href="#taller-de-entrenamiento" id="toc-taller-de-entrenamiento" class="nav-link" data-scroll-target="#taller-de-entrenamiento"><strong>Taller de entrenamiento</strong></a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller 5.1 Análisis de Escalamiento Multidimensional no Métrico - NMDS</h1>
<p class="subtitle lead">Datos de malezas en cultivos de Banano</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Javier Rodríguez Barrios </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="exploración-gráfica-multivariada---base-malezas" class="level1"><b style="color:#1f78b4;">
<h1>Exploración gráfica multivariada - base <em>malezas</em></h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<p><strong>Objetivo de la actividad:</strong></p>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La siguiente base de datos, corresponde a una muestra de 50 especies de malezas asociadas a cultivos de banano en cuatro localidades del Departamento del Magdalena (Regiones Alta, Norte, Media y Baja), basado en la composición y abundancia de estas especies vegetales. Estos datos fueron tomados del estudio realizado por Quintero-Pertuz et al., 2020) y solo representan a una parte de los taxones registrados (en total fueron 202 especies). Se utilizará el siguiente archivo como base de datos: <strong>maezas.csv</strong></p>
<p>Ejercicio tomado de: Rodríguez-Barrios (2023) <a href="https://www.editdiazdesantos.com/libros/9788490524817/Rodr%C3%ADguez-Barrios-An%C3%A1lisis-de-datos-ecol%C3%B3gicos-y-ambientales-aplicaciones-con-el-programa-R.html?isbn=978849052481">Enlace del libro</a></p>
<p><a href="https://www.editdiazdesantos.com/libros/lanza_anejo.php?isbn=9788490524817&amp;formato=.zip">Enlace de los archivos del libro</a></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="procedimiento-de-la-exploración" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="procedimiento-de-la-exploración">Procedimiento de la exploración</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<ul>
<li><p>Cargar librerías requeridas</p></li>
<li><p>Cargar la base <code>malezas.csv</code></p></li>
<li><p>Correr el NMDS con una distancia binaria (Jaccard)</p></li>
<li><p>Realizar las opciones gráficas con las librerías <code>"vegan"</code> y <code>"ggplot2"</code>.</p></li>
</ul>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="cargar-las-librerías-requeridas" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="cargar-las-librerías-requeridas">Cargar las librerías requeridas</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías requeridas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (ade4)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vegan)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(analogue)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cargar-o-importar-la-base-de-datos" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span><span class="fu">read.csv2</span>(<span class="st">"malezas.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="ordenación-de-las-localidades-y-las-especies-de-malezas." class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="ordenación-de-las-localidades-y-las-especies-de-malezas.">1) Ordenación de las localidades y las especies de malezas.</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Se prsenta un estrés de 0.13 (13%) con la distancia binaria de <code>Jaccard</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 1) Ordenación con el nmds</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>datos.nmds <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(datos[,<span class="dv">3</span><span class="sc">:</span><span class="dv">52</span>],<span class="at">trace =</span> <span class="cn">FALSE</span>,<span class="at">distance =</span> <span class="st">"jaccard"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>datos.nmds</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
metaMDS(comm = datos[, 3:52], distance = "jaccard", trace = FALSE) 

global Multidimensional Scaling using monoMDS

Data:     datos[, 3:52] 
Distance: jaccard 

Dimensions: 2 
Stress:     0.1362424 
Stress type 1, weak ties
Best solution was repeated 3 times in 20 tries
The best solution was from try 3 (random start)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on 'datos[, 3:52]' </code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figuras-del-nmds-con-el-paquete-vegan" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figuras-del-nmds-con-el-paquete-vegan">2) Figuras del nmds con el paquete “vegan”</h3>
</b><section id="nmds-con-solapamiento-de-taxones" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="nmds-con-solapamiento-de-taxones">2.1 nMDS con solapamiento de taxones</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La figura muestra la ordenación de las especies de malezas con las localidades evaluadas. Muchas de las especies quedan solapadas enn la figura, en la siguiente figura se aplicará un comando para eliminar el solapamiento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fig<span class="ot">=</span><span class="fu">plot</span>(datos.nmds, <span class="at">type =</span> <span class="st">"t"</span>,<span class="at">display =</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"species"</span>),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">"Dim 2"</span>, <span class="at">xlab=</span><span class="st">"Dim 1"</span>, <span class="at">cex=</span><span class="fl">0.7</span>,<span class="at">shrink =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Texto</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(datos.nmds, <span class="at">display=</span><span class="st">"sites"</span>, <span class="at">labels =</span> <span class="fu">as.character</span>(datos<span class="sc">$</span>Finca), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">pos=</span><span class="dv">3</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Puntos *opcionales</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(datos.nmds, <span class="at">display =</span> <span class="st">"sites"</span>,<span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plano cartesiano</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Taller5.1.nmds.malezas_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="ordenación-con-el-comando-orditorp" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="ordenación-con-el-comando-orditorp">2.2 Ordenación con el comando “orditorp”</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La figura elimina el solapamiento de las especies con el comando <code>orditorp</code>. Las especies de malezas son graficadas en rojo y las fincas en color azul.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fig<span class="ot">=</span><span class="fu">plot</span>(datos.nmds, <span class="at">type =</span> <span class="st">"n"</span>,<span class="at">display =</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"species"</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">"Dim 2"</span>, <span class="at">xlab=</span><span class="st">"Dim 1"</span>, <span class="at">ex=</span><span class="fl">0.7</span>,<span class="at">shrink =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(datos.nmds, <span class="at">display=</span><span class="st">"sites"</span>, <span class="at">labels =</span> <span class="fu">as.character</span>(datos<span class="sc">$</span>Finca), </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">pos=</span><span class="dv">3</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>ordi<span class="ot">=</span><span class="fu">orditorp</span>(datos.nmds, <span class="at">display =</span> <span class="st">"species"</span>, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">shrink =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">type=</span><span class="st">"n"</span>) </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(datos.nmds, <span class="at">display =</span> <span class="st">"sites"</span>,<span class="at">cex =</span> <span class="fl">0.7</span>, </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Taller5.1.nmds.malezas_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#—-</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="nmds-con-paquete-ggplot2" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="nmds-con-paquete-ggplot2">3) NMDS con paquete ggplot2</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se utilizarán las coordenadas de las regiones, las fincas y las especies de malazas, para graficarlas con el paquete <code>ggplot2</code>, debido a que muestra unas imágenes más didácticas y compactas. El siguiente comando - <code>names(datos.nmds)</code>, permite visualizar los insumos del escalamiento multidimensional realizado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correr nuevamente el nMDS</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(datos.nmds)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "nobj"       "nfix"       "ndim"       "ndis"       "ngrp"      
 [6] "diss"       "iidx"       "jidx"       "xinit"      "istart"    
[11] "isform"     "ities"      "iregn"      "iscal"      "maxits"    
[16] "sratmx"     "strmin"     "sfgrmn"     "dist"       "dhat"      
[21] "points"     "stress"     "grstress"   "iters"      "icause"    
[26] "call"       "model"      "distmethod" "distcall"   "data"      
[31] "distance"   "converged"  "tries"      "bestry"     "engine"    
[36] "species"   </code></pre>
</div>
</div>
<p style="color:#1f78b4;">
</p><section id="coordenadas-de-los-sitios-y-el-factor-coord.sit" class="level4">
<h4 class="anchored" data-anchor-id="coordenadas-de-los-sitios-y-el-factor-coord.sit">3.1 Coordenadas de los sitios y el factor “coord.sit”</h4>
<p></p>
<p>Con el siguiente comando - <code>datos.nmds$points</code>, se extraen las coordenadas de los sitios y con el comando <code>datos$Región</code> se obtienen la columna del factor región.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Coordenadas de los sitios y el factor (coord.sit)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>coord.sit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(datos.nmds<span class="sc">$</span>points)   <span class="co"># Coordenadas de los sitios</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>sitio <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.sit)          <span class="co"># Crear una columna con nombres de los sitios</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>grp <span class="ot">&lt;-</span> datos<span class="sc">$</span>Región                   <span class="co"># Adicionar columna de grupos por región</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord.sit)                                 <span class="co"># vista resumida de las coordenadas de stios</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            MDS1       MDS2 sitio  grp
ACa -0.368865506 -0.2302085   ACa Alta
ACr  0.400345208 -0.1960918   ACr Alta
ALa -0.583056748  0.3700299   ALa Alta
BBu  0.885283106  0.1463692   BBu Baja
BLa -0.094239567  0.2144765   BLa Baja
BMa  0.001412086  0.5159347   BMa Baja</code></pre>
</div>
</div>
<p style="color:#1f78b4;">
</p><section id="coordenadas-de-los-taxones-coord.tax" class="level5">
<h5 class="anchored" data-anchor-id="coordenadas-de-los-taxones-coord.tax">3.2 Coordenadas de los taxones “coord.tax”</h5>
<p></p>
<p>Con el comando <code>datos.nmds$species</code>, se extraen las coordenadas de las especies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Coordenadasde las especies (coord.tax) </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>coord.tax <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(datos.nmds<span class="sc">$</span>species)  <span class="co"># Dos primeros ejes</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>coord.tax<span class="sc">$</span>especies <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.tax)       <span class="co"># Insertar columna con nombres de las especies</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord.tax) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              MDS1       MDS2 especies
Acal  -0.267754978  0.1591921     Acal
Achas -0.226794835  0.3661158    Achas
Acsc   0.006701132  0.8749422     Acsc
Adein  0.629900427 -0.3486002    Adein
Adite -0.099404019 -0.1925378    Adite
Alal  -0.016473341 -0.5190497     Alal</code></pre>
</div>
</div>
<p style="color:#1f78b4;">
</p></section>
</section>
<section id="figura-con-de-elipses" class="level4">
<h4 class="anchored" data-anchor-id="figura-con-de-elipses">3.3 Figura con de elipses</h4>
<p></p>
<p>La siguiente figura presenta los comandos que se organizan por <code>sitios</code>, <code>especies</code> y el <code>factor Región</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sitios</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(MDS1,MDS2,<span class="at">label =</span> <span class="fu">as.character</span>(datos<span class="sc">$</span>Finca)),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span>   <span class="co"># Muestra el cuadro de la figura</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(MDS1,MDS2,<span class="at">colour=</span>grp),<span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Especies  </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> coord.tax,<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> MDS1, <span class="at">yend =</span> MDS2), </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="dv">0</span>,<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">0</span>,<span class="st">"cm"</span>),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),<span class="at">linetype=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">0</span>,<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.tax,<span class="fu">aes</span>(MDS1,MDS2,<span class="at">label=</span>especies),<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Factor</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data=</span>coord.sit,<span class="fu">aes</span>(<span class="at">x=</span>MDS1,<span class="at">y=</span>MDS2,<span class="at">fill=</span>grp,<span class="at">group=</span>grp),<span class="at">alpha=</span><span class="fl">0.30</span>) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>,<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>))<span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Taller5.1.nmds.malezas_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="taller-de-entrenamiento" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="taller-de-entrenamiento"><strong>Taller de entrenamiento</strong></h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p><strong>Objetivo:</strong> Poner en práctica los conceptos vistos en este taller, realizando las siguientes opciones realizando un NMDS con las variables biológicas del estudio de caso (taxones). Enviar los resultados al <em>Teams</em> del profesor.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>