<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES" xml:lang="es-ES"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez Barrios">
<meta name="dcterms.date" content="2023-03-22">

<title>Taller 8.1 Análisis de Clúster - CLA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Taller8.1.cla.bahías_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller8.1.cla.bahías_files/libs/quarto-html/quarto.js"></script>
<script src="Taller8.1.cla.bahías_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller8.1.cla.bahías_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller8.1.cla.bahías_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller8.1.cla.bahías_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller8.1.cla.bahías_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller8.1.cla.bahías_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller8.1.cla.bahías_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller8.1.cla.bahías_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#análisis-clúster---cla---base-fqmarino" id="toc-análisis-clúster---cla---base-fqmarino" class="nav-link active" data-scroll-target="#análisis-clúster---cla---base-fqmarino">Análisis Clúster - CLA - base <em>FQmarino</em></a>
  <ul>
  <li><a href="#referencias-bibliográficas-de-apoyo." id="toc-referencias-bibliográficas-de-apoyo." class="nav-link" data-scroll-target="#referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</a>
  <ul class="collapse">
  <li><a href="#cargar-las-librerías-requeridas" id="toc-cargar-las-librerías-requeridas" class="nav-link" data-scroll-target="#cargar-las-librerías-requeridas">Cargar las librerías requeridas</a></li>
  <li><a href="#cargar-o-importar-la-base-de-datos" id="toc-cargar-o-importar-la-base-de-datos" class="nav-link" data-scroll-target="#cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</a></li>
  <li><a href="#exploración-de-los-datos" id="toc-exploración-de-los-datos" class="nav-link" data-scroll-target="#exploración-de-los-datos">Exploración de los datos</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cuatro-pasos-para-el-análisis-de-clúster" id="toc-cuatro-pasos-para-el-análisis-de-clúster" class="nav-link" data-scroll-target="#cuatro-pasos-para-el-análisis-de-clúster">Cuatro pasos para el análisis de clúster</a>
  <ul>
  <li><a href="#paso-1.-distancia-entre-observaciones" id="toc-paso-1.-distancia-entre-observaciones" class="nav-link" data-scroll-target="#paso-1.-distancia-entre-observaciones">PASO 1. Distancia entre observaciones</a></li>
  <li><a href="#paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste" id="toc-paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste" class="nav-link" data-scroll-target="#paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste">PASO 2. Elección del método de agrupación de mayor ajuste</a>
  <ul class="collapse">
  <li><a href="#siete-métodos-de-agrupamiento" id="toc-siete-métodos-de-agrupamiento" class="nav-link" data-scroll-target="#siete-métodos-de-agrupamiento">2.1 Siete métodos de agrupamiento</a></li>
  <li><a href="#figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento" id="toc-figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento" class="nav-link" data-scroll-target="#figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento">2.2 Figuras de los dendogramas con los siete métodos de agrupamiento</a></li>
  <li><a href="#selección-del-mejor-método-de-agrupamiento---correlación-cofenética" id="toc-selección-del-mejor-método-de-agrupamiento---correlación-cofenética" class="nav-link" data-scroll-target="#selección-del-mejor-método-de-agrupamiento---correlación-cofenética">2.3 Selección del mejor método de agrupamiento - Correlación Cofenética</a></li>
  </ul></li>
  <li><a href="#paso-3.-número-de-grupos-formados" id="toc-paso-3.-número-de-grupos-formados" class="nav-link" data-scroll-target="#paso-3.-número-de-grupos-formados">PASO 3. Número de grupos formados</a>
  <ul class="collapse">
  <li><a href="#opción-1.-niveles-de-fusión." id="toc-opción-1.-niveles-de-fusión." class="nav-link" data-scroll-target="#opción-1.-niveles-de-fusión.">Opción 1. Niveles de Fusión.</a></li>
  <li><a href="#opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw" id="toc-opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw" class="nav-link" data-scroll-target="#opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw">Opción 2. Número optimo de clusters de acuerdo al Ancho de silueta. Índice de calidad de Rousseeuw</a></li>
  <li><a href="#figura-del-dendograma-jerárquico-final" id="toc-figura-del-dendograma-jerárquico-final" class="nav-link" data-scroll-target="#figura-del-dendograma-jerárquico-final">3.1 Figura del dendograma jerárquico final</a></li>
  <li><a href="#figura-del-dendograma-no-jerárquico-final" id="toc-figura-del-dendograma-no-jerárquico-final" class="nav-link" data-scroll-target="#figura-del-dendograma-no-jerárquico-final">3.2 Figura del dendograma no jerárquico final</a></li>
  </ul></li>
  <li><a href="#paso-4.-variables-de-mayor-contrinución-a-la-clasificación" id="toc-paso-4.-variables-de-mayor-contrinución-a-la-clasificación" class="nav-link" data-scroll-target="#paso-4.-variables-de-mayor-contrinución-a-la-clasificación">Paso 4. Variables de mayor contrinución a la clasificación</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller 8.1 Análisis de Clúster - CLA</h1>
<p class="subtitle lead">Datos de densidades de Microalgas en un río de montaña</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Javier Rodríguez Barrios </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="análisis-clúster---cla---base-fqmarino" class="level1"><b style="color:#1f78b4;">
<h1>Análisis Clúster - CLA - base <em>FQmarino</em></h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<p><strong>Objetivo de la actividad:</strong></p>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Este ejercicio se realizará con la base de datos <strong>FQmarino.csv</strong>, que ya fue utilizada en el <em>Taller 4.1 de Componentes Pincipales</em>. Esta base contiene datos de siete variables fisicoquímicas, tomadas en siete bahías de Santa Marta.</p>
<p><strong>El objetivo</strong> de este ejercicio consiste en la realización de un análisis de clúster, basado en cuatro pasos generales (distancia, método de agrupación, número de clúster y selección de variables clasificadoras), para realizar una clasificación de las bahías, basado en las variables que las caracterizan.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="referencias-bibliográficas-de-apoyo." class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
<ul>
<li><strong>Clúster Jerárquicos</strong></li>
</ul>
</b><p><b style="color:#fc8d62;"></b></p>
<p><a href="https://www.editdiazdesantos.com/libros/9788490524817/Rodr%C3%ADguez-Barrios-An%C3%A1lisis-de-datos-ecol%C3%B3gicos-y-ambientales-aplicaciones-con-el-programa-R.html?isbn=978849052481">Libro: Análisis de datos ecológicos y ambientales - Rodríguez-Barrios Javier 2023</a> Se detallan todos los procedimientos descritos en el presente ejercicio.</p>
<p><a href="http://www.scielo.org.co/scielo.php?script=sci_arttext&amp;pid=S0370-39082018000400330">Microalgas de la CGSM - Vidal et al.&nbsp;(2018)</a>. Implementación de un cluster no jerárquico para valorar paleoambientes con microalgas de la Ciénaga Grande de Santa Marta.</p>
<p><a href="https://rpubs.com/kfhidalgoh/300948">Cluster</a> Brinda información complementaria para los diferentes pasos que requiere un análisis de clúster.</p>
<p><a href="https://www.cienciadedatos.net/documentos/37_clustering_y_heatmaps">Clustering y heatmaps</a> Similar al anterior enlace, brinda información detallada sobre el análisis de clúster.</p>
<p><a href="https://rquer.netlify.app/clustering/">Análisis de conglomerados</a> Otro enlace con información general sobre los clúster.</p>
<p><a href="https://rpubs.com/Joaquin_AR/310338">Clustering y heatmaps: aprendizaje no supervisado</a> Aplicación de clúster en diferentes disciplinas.</p>
<p><a href="https://uc-r.github.io/hc_clustering">Hierarchical Cluster Analysis</a> Enlace en el que se encuentra información sobre cluster jerárquicos y técnicas detalladas para seleccionar el número de k - clúster o grupos formados.</p>
<p><a href="https://www.datanovia.com/en/lessons/determining-the-optimal-number-of-clusters-3-must-know-methods/">Determining The Optimal Number Of Clusters</a> Información relevante para el paso 3 de este ejercicio, relacionado a la definición de los k-clúster o el número de grupos formados.</p>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
<ul>
<li><strong>Clúster no Jerárquicos</strong></li>
</ul>
</b><p><b style="color:#fc8d62;"></b></p>
<p><a href="https://uc-r.github.io/kmeans_clustering#optimal">K-means Cluster Analysis</a> Brinda información sobre la construcción de clúster no jerárquicos.</p>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
<ul>
<li><strong>Otros</strong></li>
</ul>
</b><p><b style="color:#fc8d62;"></b></p>
<p><a href="https://mran.microsoft.com/snapshot/2017-02-04/web/packages/dendextend/vignettes/introduction.html">Introduction to dendextend</a> El paquete <em>dendextend</em> brinda opciones para comparar y visualizar dendogramas. Esto complementa al paso 3 del presente ejercicio, relacionado a la definición de los k-clúster formados.</p>
<p><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/117-hcpc-hierarchical-clustering-on-principal-components-essentials/">Hierarchical Clustering on Principal Components</a> Articulación de los clúster en los análisis de componentes principales.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="cargar-las-librerías-requeridas" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="cargar-las-librerías-requeridas">Cargar las librerías requeridas</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías requeridas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(gclus)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(SciViews)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ade4)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vegan)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cargar-o-importar-la-base-de-datos" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">=</span> <span class="fu">read.csv2</span>(<span class="st">"FQmarino.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Sitio"</span>,<span class="st">"pH"</span>,<span class="st">"Cond"</span>,<span class="st">"Turb"</span>,<span class="st">"Temp"</span>,<span class="st">"Sali"</span>,<span class="st">"CFot"</span>,<span class="st">"Oxig"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="exploración-de-los-datos" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="exploración-de-los-datos">Exploración de los datos</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Para este ejemplo se urtilizarán figuras que relacionan a dos o más variables. En casos en los que se tengan diferentes grupos definidos, se pueden incluir figuras de cajas que permitan visualizar diferencias entre dichos grupos definidos por algún factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cor</span>(datos[,<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>])            <span class="co"># Matriz de Correlación (M)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura1">Figura&nbsp;1</a> permite visualizar las relaciones lineales entre todas las parejas de variables, incluyendo a los coeficientes de correlación de Pearson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M,  <span class="at">method =</span> <span class="st">"circle"</span>,            <span class="co"># Correlaciones con circulos</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">insig=</span><span class="st">"blank"</span>,    <span class="co"># Forma del panel</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">"AOE"</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>,      <span class="co"># Ordenar por nivel de correlación</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span><span class="st">"black"</span>,             <span class="co"># Color de los coeficientes</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.8</span>,                 <span class="co"># Tamaño del texto</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">COL2</span>(<span class="st">"RdYlBu"</span>, <span class="dv">200</span>))        <span class="co"># Transparencia de los circulos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura1-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;1: Correlaciones y coeficientes de correlación.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura2">Figura&nbsp;2</a> es otra posigilidad para visualizar la relación entre las parejas de variables, pero además incluye páneles que visualizan la dispersión de los datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(<span class="at">data=</span>datos[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>)], </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"densityDiag"</span>), </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">combo =</span> <span class="st">"box"</span>), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">combo =</span> <span class="st">"dot"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Sitio))) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura2-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;2: Correlaciones, dispersión y coeficientes de correlación.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura3">Figura&nbsp;3</a> a diferencia de la anterior, clasifica a los grupos por colores y además incluye a sus coeficientes de correlación y el patrón de distribución de cada variable mediante histogramas de densidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(datos[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>)], <span class="fu">aes</span>(<span class="at">color=</span>datos<span class="sc">$</span>Sitio),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"densityDiag"</span>), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">combo =</span> <span class="st">"box"</span>), </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">combo =</span> <span class="st">"dot"</span>)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura3-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3: Correlaciones, dispersión y coeficientes de correlación, por cada grupo en comparación.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura4">Figura&nbsp;4</a> permite visualizar a una de las relaciones relevantes, diferenciando por tipos de sitios (S1 y S2).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relación trivariada - Lineal</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>panel.lm <span class="ot">=</span> <span class="cf">function</span>(x, y, ...) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  tmp<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">na.action=</span>na.omit)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(tmp, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col=</span> <span class="dv">2</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x,y, ...)}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">coplot</span>(Temp <span class="sc">~</span> CFot <span class="sc">|</span> Sitio, <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel =</span> panel.smooth, <span class="at">data=</span>datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura4-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;4: Relación bivariada en cada grupo asignado (Sitios).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura5">Figura&nbsp;5</a> es otra forma de visualizar la relación anterior, pero con el paquete “ggplot2”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> CFot, <span class="at">y =</span> Temp)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sitio) <span class="sc">+</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura5-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;5: Relación bivariada en cada grupo asignado (Sitios).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Finalmente, la <a href="#fig-figura6">Figura&nbsp;6</a> permite visualizar una relación más detallada entre dos variables seleccionadas y cuyos puntos caracterizan a cada uno de los sitios evaluados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección de una relación bivariada</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sitio" "pH"    "Cond"  "Turb"  "Temp"  "Sali"  "CFot"  "Oxig" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x=</span>CFot, <span class="at">y=</span> Temp)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Sitio), <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura6-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;6: Relación bivariada en cada grupo asignado (Sitios).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cuatro-pasos-para-el-análisis-de-clúster" class="level1"><b style="color:#1f78b4;">
<h1>Cuatro pasos para el análisis de clúster</h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se presenta el paso a paso requerido para un análisis de cluster - cla. Cabe mencionar que es un proceso algo dispendioso en tiempo, pero que brinda la posibilidad de contar con los códigos elaborados para ajustarlos de forma eficiente a otras bases de datos que requieran a este tipo de procedimientos.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="paso-1.-distancia-entre-observaciones" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-1.-distancia-entre-observaciones">PASO 1. Distancia entre observaciones</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Son muchas las distancias que pueden emplearse, pero cada una se ajusta al tipo de datos que se requieran trabajar. Para este caso se usará la <code>distancia euclídea</code>, debido a que se ajusta de manera apropiada a datos ambientales, incorporando además al comando <code>scale</code>, debido a que permite estandarizar a este tipo de variables que presentan escalas disímiles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancia</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">scale</span>(datos[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>)]))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(d.euclid,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      BTag PBet Mono Gran PGran  Rod
PBet  2.59                          
Mono  2.94 3.14                     
Gran  3.16 4.09 3.84                
PGran 3.94 3.75 4.82 2.13           
Rod   3.41 4.12 4.53 2.72  3.17     
Aero  4.47 4.54 5.22 3.47  3.30 3.55</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste">PASO 2. Elección del método de agrupación de mayor ajuste</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Son siete las opciones de dendogramas, de las cuales solo una será la que mejor se ajusta a los datos trabajados. Para ello, primero se realizarán los dendogramas y posteriormente se escogerá l de mejor ajuste con la <code>correlación cofenética</code>.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="siete-métodos-de-agrupamiento" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="siete-métodos-de-agrupamiento">2.1 Siete métodos de agrupamiento</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 1. Vecino más cercano "Cl.single", función "hclust" y método "single"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Cl.single <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"single"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 2. Vecino más lejano "Cl.complete", función "complete"  </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Cl.complete<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"complete"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 3. UPGMA función "average" Unión Promedio no Ponderado</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Cl.upgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"average"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 4. UPGMC función "mcquitty" Unión Promedio Ponderado</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Cl.upgmc<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"mcquitty"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 5. WPGMA función "centroid"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Cl.wpgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"centroid"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 6. WPGMC función "median"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Cl.wpgmc<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"median"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 7. WARD, función "ward"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Cl.ward<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"ward.D"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento">2.2 Figuras de los dendogramas con los siete métodos de agrupamiento</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se realizará un panel que contenga hasta 4 figuras de dendogramas (<a href="#fig-figura7">Figura&nbsp;7</a> y <a href="#fig-figura8">Figura&nbsp;8</a>), lo cual permite resumir al número de gráficas generadas, el comando que se empleará para incluir a varias figuras en un mismo panel grafico es <code>grid.arrange()</code> del paquete <code>gridextra</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.single, <span class="at">k =</span> <span class="dv">2</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Cercano - Single"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.complete, <span class="at">k =</span> <span class="dv">2</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Lejano - Complete"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">2</span>,           <span class="co"># k grupos (opcionales)</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio no Ponderado - upgmc"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgmc, <span class="at">k =</span> <span class="dv">2</span>,          </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio Ponderado - upgmc"</span>) </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f1,f2,f3,f4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura7-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7: Cuatro dendogramas jerárquicos con la distancia euclídea.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>f5 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgma, <span class="at">k =</span> <span class="dv">2</span>,          </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide no Ponderado - wpgma"</span>) </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>f6 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgmc, <span class="at">k =</span> <span class="dv">2</span>,          </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide Ponderado - wpgmc"</span>) </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>f7 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.ward, <span class="at">k =</span> <span class="dv">2</span>,          </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Método de Ward"</span>) </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f5,f6,f7, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura8-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;8: Tres dendogramas jerárquicos restantes, con la distancia euclídea.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="selección-del-mejor-método-de-agrupamiento---correlación-cofenética" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="selección-del-mejor-método-de-agrupamiento---correlación-cofenética">2.3 Selección del mejor método de agrupamiento - Correlación Cofenética</h3>
<ul>
<li>2.3.1 Cálculo de las correlaciones cofenéticas</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El método que presente la mayor correlación cofenética será el seleccionado. Para este caso se escogerá el dendograma con el método upgma, el cuál presenta un cofenético de 0.8234.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Correlación cofenpetica  para "single"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cofenet1 <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(Cl.single)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet1)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>simple</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7358594</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Correlación cofenética  para "complete"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>cofenet2<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.complete)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>compl <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet2)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>compl</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8113013</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Correlación cofenética  para "average"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>cofenet3<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgma)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>upgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet3)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>upgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8233726</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) CCorrelación cofenética  para "mcquitty"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>cofenet4<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgmc)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>upgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet4)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>upgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8209463</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Correlación cofenética  para "centroid"</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>cofenet5<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgma)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>wpgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet5)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>wpgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02444114</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (6) Correlación cofenética  para "median"</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>cofenet6<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgmc)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>wpgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet6)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>wpgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3397504</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (7) Correlación cofenética  para "ward"</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>cofenet7<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.ward)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>ward <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet7)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>ward</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.79712</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>2.3.2 Tabulación de las correlaciones cofenéticas</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Los siguientes comandos permitirán organizar a los siete métodos de agrupamiento, de acuerdo a su nivel de correlación cofenética.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame con cofenéticos</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>cofeneticos <span class="ot">=</span> <span class="fu">data.frame</span>(simple,compl,upgma,upgmc,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                         wpgma,wpgmc,ward)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cofenéticos por cada métodos (Met)</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>cofenet<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Met =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="at">Cofen=</span><span class="fu">t</span>(<span class="fu">round</span>(cofeneticos,<span class="dv">3</span>)))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tabla con orden descendente de cofenéticos</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>cof_ordenado <span class="ot">=</span> cofenet[<span class="fu">order</span>(cofenet<span class="sc">$</span>Cofen, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>cof_ordenado</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Met Cofen
upgma    3 0.823
upgmc    4 0.821
compl    2 0.811
ward     7 0.797
simple   1 0.736
wpgmc    6 0.340
wpgma    5 0.024</code></pre>
</div>
</div>
<p>Con este comando se puede exportar la tabla de cofenéticos como un archivo plano de <code>csv</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar tabla como csv</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv2(cof_ordenado,"cofenet.csv")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>2.3.3 Figuras de algunas correlaciones cofenéticas vs.&nbsp;matriz de distancia</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se presenta una muestra de la relación entre las matrices de distancia cofenética y de distancia euclínea, que permitió seleccionar al mejor método de agrupamiento (<a href="#fig-figura9">Figura&nbsp;9</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convertir matricesde distancia a vectores</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(d.euclid)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>d.cofenet1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet1)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>d.cofenet2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet2)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>d.cofenet3 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet3)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>d.cofenet4 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet4)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># crear un data frame con los vectores y agregar una columna de etiquetas</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>simple1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(d.euclid, d.cofenet1, d.cofenet2, d.cofenet3, d.cofenet4)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(simple1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  d.euclid d.cofenet1 d.cofenet2 d.cofenet3 d.cofenet4
1 2.592758   2.592758   2.592758   2.592758   2.592758
2 2.935826   2.935826   3.138967   3.037397   3.037397
3 3.157893   3.157893   5.222324   4.157454   4.476721
4 3.936806   3.157893   5.222324   4.157454   4.476721
5 3.412345   3.157893   5.222324   4.157454   4.476721
6 4.469605   3.300609   5.222324   4.157454   4.476721</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras correlaciones cofenéticas</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) distancia cofenética  para "unión simple" </span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet1))<span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión Simple"</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet1),<span class="dv">4</span>)),</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) distancia cofenética  para "unión completa" </span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet2))<span class="sc">+</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión Completa"</span>,</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet2),<span class="dv">4</span>)),</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) distancia cofenética  para "unión upgma" </span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>f3<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet3))<span class="sc">+</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión promedio no ponderado - upgma"</span>,</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet3),<span class="dv">4</span>)),</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) distancia cofenética  para "unión upgmc" </span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>f4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet4))<span class="sc">+</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión promedio ponderado - upgmc"</span>,</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet4),<span class="dv">4</span>)),</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f1,f2,f3,f4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura9-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;9: Cuatro regresiones entre la distancia euclídea empleada y las distancias cofenéticas de cada método de agrupamiento definido.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-3.-número-de-grupos-formados" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-3.-número-de-grupos-formados">PASO 3. Número de grupos formados</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La definición de los grupos formados, representan un insumo importante de información, debido a que permiten generar los k cluster en los que se agrupan las observaciones, basado en las variables que las caracterizan. Este insumo es relevante además, como paso previo a otras técnicas que requieren los grupos definidos a priori, como los análisis discriminantes lineales (lda) o los análisis de varianza multivariados (manovas), de igual forma, a partir de los grupos se pueden responder hipótesis enfocadas en las variaciones que pueden presentar las variables a lo largo de gradientes discretos o en cluster.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="opción-1.-niveles-de-fusión." class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="opción-1.-niveles-de-fusión.">Opción 1. Niveles de Fusión.</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La figura de niveles de fusión es una de las más utilizadas para la generación de grupos o de cluster, debido a la sencillez del componente gráfico, en el cual se definen los cluster o grupos (eje Y), dependiendo del escalón de mayor amplitud o distancia horizontal (eje X). En la <a href="#fig-figura10">Figura&nbsp;10</a> se observa que la mayor amplitud se presenta en 2 k cluster, por lo cual, el dendograma seleccionado en el paso anterior se puede clasificar en dos grupos de observaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de variables a relacionar (amb)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>amb <span class="ot">&lt;-</span> datos[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>)]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data.frame con los datos de altura, k y número de cluster</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">h =</span> Cl.upgma<span class="sc">$</span>height, <span class="at">k =</span> <span class="fu">nrow</span>(amb)<span class="sc">:</span><span class="dv">2</span>, <span class="at">cluster =</span> <span class="fu">nrow</span>(amb)<span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de dispersión y agregar etiquetas de texto</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(f1, <span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> k, <span class="at">label =</span> cluster)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">direction =</span> <span class="st">"vh"</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Personalizar el gráfico con títulos, etiquetas de ejes y paleta de colores</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Niveles de Fusión - Distancia Euclídea - UPGMA"</span>) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"k (Número de Cluster)"</span>) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"h (Altura del Nodo)"</span>) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura10" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura10-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;10: Cuatro regresiones entre la distancia euclídea empleada y las distancias cofenéticas de cada método de agrupamiento definido.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw">Opción 2. Número optimo de clusters de acuerdo al Ancho de silueta. Índice de calidad de Rousseeuw</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La amplitud de silueta es de las opciones más usadas para definir al número de k cluster o grupos del dendograma realizado. En este ejercicio también se define a dos grupos. En caso que los resultados de esta técnica sean diferentes a la anterior, se suele decidir por esta, debido a su mayor grado de precisión.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Crear un vector vacío (amb.vacio) con asw valores</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>amb.vacio <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(amb))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Silueta "sil" </span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span> (<span class="fu">nrow</span>(amb)<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(<span class="fu">cutree</span>(Cl.upgma,<span class="at">k=</span>k),d.euclid)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    amb.vacio[k]<span class="ot">&lt;-</span><span class="fu">summary</span>(sil)<span class="sc">$</span>avg.width} </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Mejor o mayor amplitud de silueta (2 particiones)</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>k.mejor <span class="ot">&lt;-</span> <span class="fu">which.max</span>(amb.vacio)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>k.mejor </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica de silueta</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(amb),amb.vacio,<span class="at">type=</span><span class="st">"h"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Silueta-Número Óptimo de Clusters"</span>, <span class="at">xlab=</span><span class="st">"(Número de grupos)"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Amplitud promedio de  silueta"</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,k.mejor,<span class="fu">paste</span>(<span class="st">"optimum"</span>,k.mejor,<span class="at">sep=</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),<span class="at">col=</span><span class="st">"red"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">font=</span><span class="dv">2</span>,<span class="at">col.axis=</span><span class="st">"red"</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(k.mejor,<span class="fu">max</span>(amb.vacio),<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">""</span>,<span class="st">"Silueta-Número óptimo de Clusters k="</span>,k.mejor,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,<span class="st">"Con una aplitud promedio de silueta"</span>,<span class="fu">max</span>(amb.vacio),<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figura-del-dendograma-jerárquico-final" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figura-del-dendograma-jerárquico-final">3.1 Figura del dendograma jerárquico final</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La <a href="#fig-figura11">Figura&nbsp;11</a> muestra la manera en la que se organizan las observaciones en los dos grupos formados (ramas rojas y azules) devido a la naturaleza de las variables fisicoquímicas que las caracterizar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dendograma final </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">2</span>,        <span class="co"># k grupos</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.9</span>,              <span class="co"># tamaño del texto de las observaciones</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio no Ponderada (UPGMA)"</span>, <span class="co"># Rotulo de título</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower_rect =</span> <span class="dv">0</span>,           <span class="co"># Inicio de los rectángulos en cero</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_colors =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#FC4E07"</span>),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">color_labels_by_k =</span> <span class="cn">TRUE</span>,    <span class="co"># Colores para cada grupo</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">rect =</span> <span class="cn">TRUE</span>)                 <span class="co"># Rectángulos de cada grupo</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura11" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura11-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;11: Dendograma jerárquico final con los dos grupos asignados.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Vale la pena mencionar que estos análisis son importantes cuando se cuenta con pocas observaciones (ramas del dendograma), en el caso contrario, es preferible utilizar dendogramas no jerarquicos como el k-meas, el cual fue descrito en uno de los complementos del PCA y se retoma a continuación.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figura-del-dendograma-no-jerárquico-final" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figura-del-dendograma-no-jerárquico-final">3.2 Figura del dendograma no jerárquico final</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>Agrupamiento elegido en el paso 2 (upgma)</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancia</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">scale</span>(datos[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>)]))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 3. UPGMA función "average" Unión Promedio no Ponderado</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>Cl.upgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"average"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>Generación de la variable agrupadora (<strong>gr</strong>)</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable agrupadora con k=2 clúster</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">cutree</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">2</span>)    <span class="co"># Grupos generados "grp"  </span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>grl <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">factor</span>(grp))        <span class="co"># Rotulos de los grupos formados</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Este es un paso opcional en caso que se requiera insertar la nueva variable agrupadora a la base de datos en revisión.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Incluir la variable agrupadora en la base de datos</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>datos<span class="fl">.1</span><span class="ot">=</span><span class="fu">data.frame</span>(grp,datos)       <span class="co"># Nuevo dataframe con la variable agrupadora (gr)</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (datos<span class="fl">.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      grp Sitio    pH   Cond  Turb   Temp  Sali  CFot  Oxig
BTag    1    S1 8.421 37.982 1.364 29.500 2.422 19.72 0.097
PBet    1    S1 8.490 38.073 0.545 29.545 2.431 22.10 0.147
Mono    1    S1 8.505 37.836 1.273 29.600 2.416 22.10 0.331
Gran    2    S1 8.562 37.336 1.273 29.255 2.382 10.80 0.170
PGran   2    S2 8.608 37.255 0.636 29.291 2.375  9.00 0.098
Rod     2    S2 8.808 38.063 1.273 29.310 2.380  8.80 0.098</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>Generación del clúster No Jerárquico (<strong>K-Means</strong>)</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La <a href="#fig-figura12">Figura&nbsp;12</a> es la forma no jerárquica de presentar los resultados del cluster definido por el método de agrupamiento <code>upgma</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> amb, <span class="at">cluster =</span> grp),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#2E9FDF"</span>, <span class="st">"#FC4E07"</span>),  <span class="co"># Colores para cada grupo</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"confidence"</span>,        <span class="co"># Elipses</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>,                 <span class="co"># Elimina solapamiento de observaciones</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.clust.cent =</span> <span class="cn">FALSE</span>,      <span class="co"># Muestra a los clúster centrados</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())     <span class="co"># Tipo de fondo tomado de ggplot2</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura12" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura12-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;12: Dendograma no jerárquico final con los dos grupos asignados.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Una pregunta interesante que se podría resolver, sería valorar si las diferencias entre los dos grupos de observaciones formadas es estadísticamente significativa, para lo cual se debe aplicar un análisis de varianza multivariado (manova).</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-4.-variables-de-mayor-contrinución-a-la-clasificación" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-4.-variables-de-mayor-contrinución-a-la-clasificación">Paso 4. Variables de mayor contrinución a la clasificación</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se realizan diferentes opciones de <strong>mapas de calor</strong> (<a href="#fig-figura13">Figura&nbsp;13</a>, <a href="#fig-figura14">Figura&nbsp;14</a>), para identifiar a las variables con mayor relevancia en la clasificación realizada anteriormente en el dendograma seleccionado. Este paso es relevante cuando se quiere ponderar o seleecionar a las variables que aportan al análisis, resumiento de esta forma, la dimensionalidad del problema (número de variables).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>amb1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(amb)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 1. Mapa de calor con paquete "stats"</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>hv <span class="ot">&lt;-</span> <span class="fu">heatmap</span>(amb1, <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">6</span>), </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">distfun =</span> dist,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span><span class="st">"Variables fisico-químicas"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab=</span> <span class="st">"Bahías"</span>, </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">main =</span> <span class="st">"Clasificación de Bahías"</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="st">"row"</span>)   <span class="co"># Estandariza variables diferentes.</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura13" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura13-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;13: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificación realizada.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>El siguiente mapa de calor (<a href="#fig-figura14">Figura&nbsp;14</a>) incorpora a la distancia euclídea utilizada y el método de agrupamiento seleccionado (upgma).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2. Mapa de calor con paquete "stats"</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>hclust.fq <span class="ot">&lt;-</span> <span class="cf">function</span>(amb1) <span class="fu">hclust</span>(amb1, <span class="at">method=</span><span class="st">"average"</span>)   <span class="co"># Inserción de agrupación UPGMA</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(amb1,               <span class="co"># Base de datos en formato matricial</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">7</span>),     <span class="co"># Margenes de la figura</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="st">"row"</span>,      <span class="co"># Estandariza variables diferentes.</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">bluered</span>(<span class="dv">100</span>),                 <span class="co"># Colores del mapa de calor</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span><span class="st">"Variables fisico-químicas"</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span> <span class="st">"Bahías"</span>, </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Clasificación de Bahías"</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>, </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">distfun =</span> dist,          <span class="co"># Se puede usar vegdist de "vegan" </span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclustfun=</span>hclust.fq)     <span class="co"># Agrupamiento UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura14" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller8.1.cla.bahías_files/figure-html/fig-figura14-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;14: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificación realizada.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><strong>Nota</strong>: Es posible hacer mapas de calor cruzando a las variables con los grupos asignados. Este procedimiento se presentará en el ejercicio de análisis discriminante.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>